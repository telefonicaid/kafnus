from common_test import multiservice_stack, ServiceOperations, read_files, OrionRequestData, KafkaMessages
from pathlib import Path

streetlight = read_files(Path("streetlight.json"))
wasteContainer = read_files(Path("wasteContainer.json"))

alcobendas_streelight_streelight = OrionRequestData(
    name="alcobendas_streelight_streelight",
    service="alcobendas",
    subservice="/streelight",
    subscriptions={"historic":streetlight["subscriptions"]["lastdata"]},
    updateEntities= streetlight["updateEntities"]
)

alcobendas_dumps_wastecontainer = OrionRequestData(
    name="alcobendas_dumps_wastecontainer",
    service="alcobendas",
    subservice="/dumps",
    subscriptions={"historic":wasteContainer["subscriptions"]["lastdata"]},
    updateEntities= wasteContainer["updateEntities"],
)

jcyl_dumps_wastecontainer = OrionRequestData(
    name="jcyl_dumps_wastecontainer",
    service="jcyl",
    subservice="/dumps",
    subscriptions={"historic":wasteContainer["subscriptions"]["lastdata"]},
    updateEntities= wasteContainer["updateEntities"],
)

def test_services_operations_one_entity(multiservice_stack):
    #  Given
    entry= [alcobendas_streelight_streelight]
    expected_data_kafka = [
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:15:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350063, 40.054448]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 9. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.5, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '20 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 25}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': '@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 15, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483647, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203685, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1989.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4000.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 30.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.5e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10001, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [10, 25, 50, 75, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2700, 3000, 4000, 5000, 6500], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:20:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350163, 40.054548]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 10. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.6, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '21 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 26}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_tecnico@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 16, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483648, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203686, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1990.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4100.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 31.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.6e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10002, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [15, 30, 55, 80, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2750, 3100, 4100, 5100, 6600], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:25:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350263, 40.054648]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 11. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.7, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '22 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 27}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'asistencia@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 17, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483649, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203687, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1991.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4200.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 32.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.7e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10003, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [20, 35, 60, 85, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2800, 3200, 4200, 5200, 6700], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:30:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350363, 40.054748]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 12. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.8, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '23 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 28}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 18, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483650, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203688, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1992.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4300.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 33.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.8e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10004, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Nova', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [25, 40, 65, 90, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2850, 3300, 4300, 5300, 6800], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:35:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350463, 40.054848]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 13. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.9, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '24 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'eco-mode'], 'sensors': {'motion': True, 'ambient_light': True}, 'zigbee_channel': 29}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'tecnico@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 19, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483651, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203689, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1993.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4400.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 34.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.9e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10005, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Omega', 'STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [30, 45, 70, 95, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2900, 3400, 4400, 5400, 6900], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:40:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350563, 40.054948]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 14. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 1, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '25 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': False}, 'zigbee_channel': 30}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'asistencia_tecnica@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 20, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483652, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203690, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1994.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4500.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 35.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.999999999999999e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10006, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [35, 50, 75, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2950, 3500, 4500, 5500, 7000], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:45:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350663, 40.055048]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 15. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.4, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '26 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency'], 'sensors': {'motion': True, 'ambient_light': True}, 'zigbee_channel': 31}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_luminica@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 21, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483653, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203691, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1995.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4600.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 36.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.1e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10007, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Omega', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [40, 55, 80, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3000, 3600, 4600, 5600, 7100], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:50:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350763, 40.055148]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 16. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.3, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '27 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color'], 'sensors': {'motion': False, 'ambient_light': False}, 'zigbee_channel': 32}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'mantenimiento@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 22, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483654, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203692, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1996.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4700.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 37.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.2e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10008, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [45, 60, 85, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3050, 3700, 4700, 5700, 7200], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:55:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350863, 40.055248]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 17. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.2, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '28 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['eco-mode'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 33}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_iluminacion@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 23, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483655, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203693, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1997.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4800.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 38.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.3e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10009, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova', 'STL-Quantum', 'STL-Alpha'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [50, 65, 90, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3100, 3800, 4800, 5800, 7300], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T06:00:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350963, 40.055348]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 18. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.1, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '29 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 34}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'ayuda@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 24, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483656, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203694, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1998.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4900.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 39.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.4e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10010, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [55, 70, 95, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3150, 3900, 4900, 5900, 7400], 'metadata': {}}}]})
    ]
    service_operations = ServiceOperations(multiservice_stack, entry)
    service_operations.subscribe_to_kafka_topics()
    # when
    service_operations.orion_set_up()
    result_kafka = service_operations.check_messages_on_kafka()
    # Then
    assert all(elem in result_kafka for elem in expected_data_kafka)

def test_services_operations_two_entities_different_subservice(multiservice_stack):
    #  Given
    entry= [alcobendas_streelight_streelight, alcobendas_dumps_wastecontainer]
    expected_data_kafka = [
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:15:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350063, 40.054448]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 9. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.5, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '20 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 25}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': '@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 15, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483647, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203685, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1989.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4000.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 30.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.5e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10001, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [10, 25, 50, 75, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2700, 3000, 4000, 5000, 6500], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:20:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350163, 40.054548]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 10. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.6, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '21 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 26}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_tecnico@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 16, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483648, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203686, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1990.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4100.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 31.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.6e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10002, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [15, 30, 55, 80, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2750, 3100, 4100, 5100, 6600], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:25:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350263, 40.054648]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 11. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.7, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '22 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 27}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'asistencia@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 17, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483649, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203687, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1991.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4200.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 32.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.7e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10003, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [20, 35, 60, 85, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2800, 3200, 4200, 5200, 6700], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:30:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350363, 40.054748]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 12. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.8, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '23 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 28}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 18, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483650, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203688, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1992.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4300.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 33.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.8e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10004, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Nova', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [25, 40, 65, 90, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2850, 3300, 4300, 5300, 6800], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:35:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350463, 40.054848]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 13. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.9, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '24 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'eco-mode'], 'sensors': {'motion': True, 'ambient_light': True}, 'zigbee_channel': 29}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'tecnico@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 19, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483651, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203689, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1993.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4400.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 34.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.9e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10005, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Omega', 'STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [30, 45, 70, 95, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2900, 3400, 4400, 5400, 6900], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:40:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350563, 40.054948]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 14. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 1, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '25 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': False}, 'zigbee_channel': 30}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'asistencia_tecnica@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 20, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483652, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203690, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1994.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4500.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 35.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.999999999999999e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10006, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [35, 50, 75, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2950, 3500, 4500, 5500, 7000], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:45:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350663, 40.055048]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 15. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.4, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '26 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency'], 'sensors': {'motion': True, 'ambient_light': True}, 'zigbee_channel': 31}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_luminica@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 21, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483653, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203691, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1995.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4600.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 36.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.1e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10007, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Omega', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [40, 55, 80, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3000, 3600, 4600, 5600, 7100], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:50:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350763, 40.055148]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 16. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.3, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '27 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color'], 'sensors': {'motion': False, 'ambient_light': False}, 'zigbee_channel': 32}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'mantenimiento@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 22, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483654, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203692, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1996.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4700.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 37.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.2e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10008, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [45, 60, 85, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3050, 3700, 4700, 5700, 7200], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:55:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350863, 40.055248]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 17. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.2, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '28 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['eco-mode'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 33}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_iluminacion@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 23, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483655, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203693, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1997.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4800.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 38.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.3e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10009, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova', 'STL-Quantum', 'STL-Alpha'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [50, 65, 90, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3100, 3800, 4800, 5800, 7300], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T06:00:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350963, 40.055348]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 18. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.1, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '29 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 34}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'ayuda@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 24, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483656, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203694, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1998.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4900.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 39.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.4e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10010, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [55, 70, 95, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3150, 3900, 4900, 5900, 7400], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T07:20:15.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.351782, 40.052917]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Sostenibilidad, 12. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 42.1, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'operational', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'plastic', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 24.8, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-29T07:45:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 800, 'compactor': False, 'sensors': ['fill', 'tilt'], 'material': 'steel'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-20', 'frequency': 'monthly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-PLA-03', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 88.5, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 1.2, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.08, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 621.7, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['plastic', 'packaging'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-22T07:30:00Z', '2024-12-15T08:00:00Z', '2024-12-08T07:50:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'residuos@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T08:45:30.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.349021, 40.055732]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Avenida Ecología, 3. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 91.7, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'full', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'glass', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 22.1, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-28T09:20:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 1500, 'compactor': True, 'sensors': ['fill', 'temperature'], 'material': 'recycled_metal'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-10', 'frequency': 'weekly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-GLS-12', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 76.3, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.5, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.03, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 215, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 1328.9, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['glass'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-21T09:10:00Z', '2024-12-14T09:45:00Z', '2024-12-07T08:55:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'reciclaje@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T06:30:45.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.348456, 40.053289]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Plaza Circular, 7. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 18.9, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'maintenance', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'paper', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 26.3, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-31T10:15:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 600, 'compactor': False, 'sensors': ['fill'], 'material': 'plastic'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-05', 'frequency': 'as_needed'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-PPR-09', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 95.8, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.9, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.21, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 387.4, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['paper', 'cardboard'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-24T10:30:00Z', '2024-12-17T11:00:00Z', '2024-12-10T10:20:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'papel@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T09:15:22.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.352114, 40.056842]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Camino Compost, 22. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 77.5, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'operational', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'organic', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 31.2, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-30T06:50:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 2000, 'compactor': True, 'sensors': ['fill', 'temperature', 'gas'], 'material': 'stainless_steel'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-18', 'frequency': 'biweekly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-BIO-15', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 81.7, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 4.3, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.32, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 342, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 1782.6, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['organic', 'green_waste'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-23T06:40:00Z', '2024-12-16T07:15:00Z', '2024-12-09T06:55:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'organico@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T10:05:18.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.347889, 40.051673]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Bulevar Recuperación, 15. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 5.3, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'empty', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'metal', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 19.7, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-31T12:00:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 1000, 'compactor': True, 'sensors': ['fill', 'weight'], 'material': 'aluminum'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-02-01', 'frequency': 'monthly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-MET-04', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 99.2, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.2, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.01, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 89, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 723.1, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['metal', 'cans'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-24T12:20:00Z', '2024-12-17T11:45:00Z', '2024-12-10T12:10:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'metal@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T11:22:37.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.353297, 40.054126]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Paseo Sostenible, 8. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 63.8, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'operational', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'textile', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 23.5, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-27T14:30:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 500, 'compactor': False, 'sensors': ['fill'], 'material': 'fiberglass'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-25', 'frequency': 'monthly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-TXT-11', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 85, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 1.8, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.12, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 412.6, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['textile', 'shoes'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-20T14:45:00Z', '2024-12-13T15:10:00Z', '2024-12-06T14:20:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'textil@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T12:40:55.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350872, 40.057319]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Glorieta Reciclado, 1. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 96.2, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'critical', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'mixed', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 29.8, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-26T16:00:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 1800, 'compactor': True, 'sensors': ['fill', 'temperature', 'odor'], 'material': 'recycled_plastic'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-08', 'frequency': 'weekly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-MIX-22', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 67.4, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 4.9, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.45, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 198, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 1692.3, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['residual', 'mixed'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-19T16:20:00Z', '2024-12-12T16:50:00Z', '2024-12-05T16:10:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'residual@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T13:18:43.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.346523, 40.055001]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Callejón Orgánico, 9. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 33.7, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'operational', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'bio', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 27.1, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-30T11:45:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 950, 'compactor': False, 'sensors': ['fill', 'humidity'], 'material': 'composite'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-22', 'frequency': 'biweekly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-BIO-08', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 93.6, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 3.1, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.19, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 698.2, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['organic', 'bio_waste'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-23T11:30:00Z', '2024-12-16T12:15:00Z', '2024-12-09T11:50:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'bio@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T14:55:29.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.354761, 40.053874]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Travesía Limpieza, 4. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 52.4, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'needs_cleaning', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'hazardous', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 18.3, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-25T13:15:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 300, 'compactor': False, 'sensors': ['fill', 'leak'], 'material': 'chemical_resistant'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-03', 'frequency': 'daily'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-HAZ-19', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 100, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.7, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.27, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 245.8, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['batteries', 'chemicals'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-18T13:40:00Z', '2024-12-11T14:05:00Z', '2024-12-04T13:25:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'peligrosos@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T15:33:14.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.349635, 40.058212]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Vereda Verde, 18. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 29.6, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'offline', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'electronic', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 21.4, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-29T17:30:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 400, 'compactor': False, 'sensors': ['fill', 'tamper'], 'material': 'anti_static'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-17', 'frequency': 'monthly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-ELE-05', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 45.2, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.3, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.06, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 321.9, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['electronics', 'batteries'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-22T17:50:00Z', '2024-12-15T18:20:00Z', '2024-12-08T17:35:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'electronicos@ayto-argelita.es', 'metadata': {}}}]})
    ]
    service_operations = ServiceOperations(multiservice_stack, entry)
    service_operations.subscribe_to_kafka_topics()
    # when
    service_operations.orion_set_up()
    result_kafka = service_operations.check_messages_on_kafka()
    # Then
    assert all(elem in result_kafka for elem in expected_data_kafka)

def test_services_operations_two_entities_different_subservice_and_different_service(multiservice_stack):
    #  Given
    entry= [alcobendas_streelight_streelight, jcyl_dumps_wastecontainer]
    expected_data_kafka = [
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:15:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350063, 40.054448]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 9. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.5, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '20 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 25}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': '@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 15, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483647, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203685, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1989.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4000.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 30.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.5e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10001, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [10, 25, 50, 75, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2700, 3000, 4000, 5000, 6500], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:20:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350163, 40.054548]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 10. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.6, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '21 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 26}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_tecnico@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 16, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483648, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203686, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1990.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4100.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 31.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.6e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10002, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [15, 30, 55, 80, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2750, 3100, 4100, 5100, 6600], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:25:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350263, 40.054648]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 11. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.7, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '22 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 27}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'asistencia@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 17, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483649, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203687, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1991.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4200.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 32.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.7e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10003, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [20, 35, 60, 85, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2800, 3200, 4200, 5200, 6700], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:30:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350363, 40.054748]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 12. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.8, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '23 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 28}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 18, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483650, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203688, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1992.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4300.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 33.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.8e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10004, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Nova', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [25, 40, 65, 90, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2850, 3300, 4300, 5300, 6800], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:35:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350463, 40.054848]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 13. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.9, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '24 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'eco-mode'], 'sensors': {'motion': True, 'ambient_light': True}, 'zigbee_channel': 29}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'tecnico@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 19, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483651, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203689, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1993.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4400.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 34.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.9e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10005, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Omega', 'STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [30, 45, 70, 95, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2900, 3400, 4400, 5400, 6900], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:40:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350563, 40.054948]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 14. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 1, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '25 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': False}, 'zigbee_channel': 30}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'asistencia_tecnica@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 20, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483652, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203690, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1994.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4500.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 35.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 6.999999999999999e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10006, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [35, 50, 75, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [2950, 3500, 4500, 5500, 7000], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:45:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350663, 40.055048]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 15. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.4, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '26 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency'], 'sensors': {'motion': True, 'ambient_light': True}, 'zigbee_channel': 31}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_luminica@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 21, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483653, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203691, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1995.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4600.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 36.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.1e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10007, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Omega', 'STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [40, 55, 80, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3000, 3600, 4600, 5600, 7100], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:50:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350763, 40.055148]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 16. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.3, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '27 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['dynamic-color'], 'sensors': {'motion': False, 'ambient_light': False}, 'zigbee_channel': 32}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'mantenimiento@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 22, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483654, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203692, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1996.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4700.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 37.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.2e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10008, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Nova'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [45, 60, 85, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3050, 3700, 4700, 5700, 7200], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T05:55:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350863, 40.055248]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 17. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.2, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': True, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '28 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['eco-mode'], 'sensors': {'motion': True, 'ambient_light': False}, 'zigbee_channel': 33}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'soporte_iluminacion@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 23, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483655, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203693, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1997.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4800.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 38.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.3e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10009, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Gamma', 'STL-Omega', 'STL-Nova', 'STL-Quantum', 'STL-Alpha'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [50, 65, 90, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3100, 3800, 4800, 5800, 7300], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'alcobendas', 'fiware-servicepath': 'streelight'}, message={'data': [{'id': 'ENT-LUM-001', 'type': 'Streetlight', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T06:00:00.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350963, 40.055348]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Honorato Ros, 18. 12230 Argelita, Castell�n', 'metadata': {}}, 'illuminanceLevel': {'type': 'Number', 'value': 0.1, 'metadata': {}}, 'enableHistoricCommand': {'type': 'Boolean', 'value': False, 'metadata': {}}, 'variables': {'type': 'jsonb', 'value': {'duration': '29 days'}, 'metadata': {}}, 'fixtureConfiguration': {'type': 'json', 'value': {'modes': ['high-efficiency', 'dynamic-color', 'eco-mode'], 'sensors': {'motion': False, 'ambient_light': True}, 'zigbee_channel': 34}, 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'ayuda@telefonica.com', 'metadata': {}}, 'lumensAdjustment': {'type': 'Number', 'value': 24, 'metadata': {}}, 'fixtureModelId': {'type': 'Number', 'value': 2147483656, 'metadata': {}}, 'ledCount': {'type': 'Number', 'value': 922337203694, 'metadata': {}}, 'wattageConsumption': {'type': 'Number', 'value': 1998.0, 'metadata': {}}, 'colorTempKelvin': {'type': 'Number', 'value': 4900.1234, 'metadata': {}}, 'beamAngle': {'type': 'Number', 'value': 39.75, 'metadata': {}}, 'luminousEfficacy': {'type': 'Number', 'value': 7.4e+39, 'metadata': {}}, 'installationId': {'type': 'Number', 'value': 10010, 'metadata': {}}, 'compatibleFixtures': {'type': 'json', 'value': ['STL-Quantum'], 'metadata': {}}, 'dimmingLevels': {'type': 'json', 'value': [55, 70, 95, 100], 'metadata': {}}, 'temperatureRangeK': {'type': 'json', 'value': [3150, 3900, 4900, 5900, 7400], 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T07:20:15.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.351782, 40.052917]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Calle Sostenibilidad, 12. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 42.1, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'operational', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'plastic', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 24.8, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-29T07:45:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 800, 'compactor': False, 'sensors': ['fill', 'tilt'], 'material': 'steel'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-20', 'frequency': 'monthly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-PLA-03', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 88.5, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 1.2, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.08, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 621.7, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['plastic', 'packaging'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-22T07:30:00Z', '2024-12-15T08:00:00Z', '2024-12-08T07:50:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'residuos@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T08:45:30.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.349021, 40.055732]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Avenida Ecología, 3. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 91.7, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'full', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'glass', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 22.1, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-28T09:20:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 1500, 'compactor': True, 'sensors': ['fill', 'temperature'], 'material': 'recycled_metal'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-10', 'frequency': 'weekly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-GLS-12', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 76.3, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.5, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.03, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 215, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 1328.9, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['glass'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-21T09:10:00Z', '2024-12-14T09:45:00Z', '2024-12-07T08:55:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'reciclaje@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T06:30:45.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.348456, 40.053289]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Plaza Circular, 7. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 18.9, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'maintenance', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'paper', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 26.3, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-31T10:15:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 600, 'compactor': False, 'sensors': ['fill'], 'material': 'plastic'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-05', 'frequency': 'as_needed'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-PPR-09', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 95.8, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.9, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.21, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 387.4, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['paper', 'cardboard'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-24T10:30:00Z', '2024-12-17T11:00:00Z', '2024-12-10T10:20:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'papel@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T09:15:22.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.352114, 40.056842]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Camino Compost, 22. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 77.5, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'operational', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'organic', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 31.2, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-30T06:50:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 2000, 'compactor': True, 'sensors': ['fill', 'temperature', 'gas'], 'material': 'stainless_steel'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-18', 'frequency': 'biweekly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-BIO-15', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 81.7, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 4.3, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.32, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 342, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 1782.6, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['organic', 'green_waste'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-23T06:40:00Z', '2024-12-16T07:15:00Z', '2024-12-09T06:55:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'organico@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T10:05:18.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.347889, 40.051673]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Bulevar Recuperación, 15. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 5.3, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'empty', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'metal', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 19.7, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-31T12:00:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 1000, 'compactor': True, 'sensors': ['fill', 'weight'], 'material': 'aluminum'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-02-01', 'frequency': 'monthly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-MET-04', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 99.2, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.2, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.01, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 89, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 723.1, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['metal', 'cans'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-24T12:20:00Z', '2024-12-17T11:45:00Z', '2024-12-10T12:10:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'metal@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T11:22:37.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.353297, 40.054126]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Paseo Sostenible, 8. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 63.8, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'operational', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'textile', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 23.5, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-27T14:30:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 500, 'compactor': False, 'sensors': ['fill'], 'material': 'fiberglass'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-25', 'frequency': 'monthly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-TXT-11', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 85, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 1.8, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.12, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 412.6, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['textile', 'shoes'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-20T14:45:00Z', '2024-12-13T15:10:00Z', '2024-12-06T14:20:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'textil@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T12:40:55.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.350872, 40.057319]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Glorieta Reciclado, 1. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 96.2, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'critical', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'mixed', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 29.8, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-26T16:00:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 1800, 'compactor': True, 'sensors': ['fill', 'temperature', 'odor'], 'material': 'recycled_plastic'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-08', 'frequency': 'weekly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-MIX-22', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 67.4, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 4.9, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.45, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 198, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 1692.3, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['residual', 'mixed'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-19T16:20:00Z', '2024-12-12T16:50:00Z', '2024-12-05T16:10:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'residual@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T13:18:43.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.346523, 40.055001]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Callejón Orgánico, 9. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 33.7, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'operational', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'bio', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 27.1, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-30T11:45:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 950, 'compactor': False, 'sensors': ['fill', 'humidity'], 'material': 'composite'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-22', 'frequency': 'biweekly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-BIO-08', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 93.6, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 3.1, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.19, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 698.2, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['organic', 'bio_waste'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-23T11:30:00Z', '2024-12-16T12:15:00Z', '2024-12-09T11:50:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'bio@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T14:55:29.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.354761, 40.053874]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Travesía Limpieza, 4. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 52.4, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'needs_cleaning', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'hazardous', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 18.3, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-25T13:15:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 300, 'compactor': False, 'sensors': ['fill', 'leak'], 'material': 'chemical_resistant'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-03', 'frequency': 'daily'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-HAZ-19', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 100, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.7, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.27, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 245.8, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['batteries', 'chemicals'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-18T13:40:00Z', '2024-12-11T14:05:00Z', '2024-12-04T13:25:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'peligrosos@ayto-argelita.es', 'metadata': {}}}]}),
        KafkaMessages(topic='raw_lastdata', headers={'fiware-service': 'jcyl', 'fiware-servicepath': 'dumps'}, message={'data': [{'id': 'ENT-WST-001', 'type': 'WasteContainer', 'TimeInstant': {'type': 'DateTime', 'value': '2025-01-01T15:33:14.000Z', 'metadata': {}}, 'location': {'type': 'geo:json', 'value': {'type': 'Point', 'coordinates': [-0.349635, 40.058212]}, 'metadata': {}}, 'address': {'type': 'Text', 'value': 'Vereda Verde, 18. 12230 Argelita, Castellón', 'metadata': {}}, 'fillLevel': {'type': 'Number', 'value': 29.6, 'metadata': {}}, 'containerStatus': {'type': 'Text', 'value': 'offline', 'metadata': {}}, 'wasteType': {'type': 'Text', 'value': 'electronic', 'metadata': {}}, 'temperature': {'type': 'Number', 'value': 21.4, 'metadata': {}}, 'lastCollection': {'type': 'DateTime', 'value': '2024-12-29T17:30:00.000Z', 'metadata': {}}, 'containerConfiguration': {'type': 'json', 'value': {'capacity_kg': 400, 'compactor': False, 'sensors': ['fill', 'tamper'], 'material': 'anti_static'}, 'metadata': {}}, 'maintenanceSchedule': {'type': 'jsonb', 'value': {'next_service': '2025-01-17', 'frequency': 'monthly'}, 'metadata': {}}, 'collectionRouteId': {'type': 'Text', 'value': 'RT-ELE-05', 'metadata': {}}, 'batteryLevel': {'type': 'Number', 'value': 45.2, 'metadata': {}}, 'odorLevel': {'type': 'Number', 'value': 0.3, 'metadata': {}}, 'fireRiskIndex': {'type': 'Number', 'value': 0.06, 'metadata': {}}, 'compactionCycles': {'type': 'Number', 'value': 0, 'metadata': {}}, 'containerWeight': {'type': 'Number', 'value': 321.9, 'metadata': {}}, 'supportedWasteTypes': {'type': 'json', 'value': ['electronics', 'batteries'], 'metadata': {}}, 'collectionHistory': {'type': 'json', 'value': ['2024-12-22T17:50:00Z', '2024-12-15T18:20:00Z', '2024-12-08T17:35:00Z'], 'metadata': {}}, 'maintainerEmail': {'type': 'TextUnrestricted', 'value': 'electronicos@ayto-argelita.es', 'metadata': {}}}]})
    ]
    service_operations = ServiceOperations(multiservice_stack, entry)
    service_operations.subscribe_to_kafka_topics()
    # when
    service_operations.orion_set_up()
    result_kafka = service_operations.check_messages_on_kafka()
    # Then
    assert all(elem in result_kafka for elem in expected_data_kafka)

